(()=>{"use strict";chrome.runtime.onInstalled.addListener(function(){console.log("Extension installed!"),chrome.action.setBadgeText({text:"NEW"}),chrome.action.setBadgeBackgroundColor({color:"#9945FF"}),setTimeout(function(){chrome.action.setBadgeText({text:""})},5e3)}),chrome.storage.onChanged.addListener(function(e,o){"local"===o&&e.walletConnected&&(!0===e.walletConnected.newValue?(chrome.action.setBadgeText({text:"SOL"}),chrome.action.setBadgeBackgroundColor({color:"#14F195"})):chrome.action.setBadgeText({text:""}))});const e=["http://localhost:8000/wallet-connect.html","https://localhost:8443/wallet-connect.html"];chrome.runtime.onMessage.addListener(function(o,t,n){if("checkWalletConnection"===o.action)return chrome.storage.local.get(["walletConnected","walletPublicKey"],function(e){n({connected:e.walletConnected||!1,publicKey:e.walletPublicKey||null})}),!0;if("walletConnected"===o.action||"wallet_connected"===o.action){console.log("Wallet connected from external page:",o.publicKey||o.address);const e=o.publicKey||o.address;return e?function(e,o){console.log("Wallet connected with public key:",e),chrome.storage.local.set({walletConnected:!0,walletPublicKey:e}),chrome.action.setBadgeText({text:"SOL"}),chrome.action.setBadgeBackgroundColor({color:"#14F195"}),o&&o({status:"success"})}(e,n):(console.error("No public key provided in wallet connection message"),n({status:"error",message:"No public key provided"})),!0}return"openWalletConnect"===o.action?(chrome.storage.local.get(["useLocalDevelopment"],function(o){let t="https://hoepeyemi.github.io/xtension/wallet-connect.html";o.useLocalDevelopment?(t=e[0],console.log("Using local development URL:",t)):console.log("Using GitHub Pages URL:",t),chrome.tabs.create({url:t},function(e){console.log("Opened wallet connect page in tab:",e.id)})}),n({status:"opening"}),!0):"toggleDevelopmentMode"===o.action?(chrome.storage.local.get(["useLocalDevelopment"],function(e){const o=!e.useLocalDevelopment;chrome.storage.local.set({useLocalDevelopment:o}),n({status:"success",useLocalDevelopment:o,message:o?"Using local development URLs":"Using GitHub Pages URL"})}),!0):void 0})})();